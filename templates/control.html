<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMART GREENHOUSE</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    
    <div class="title"><img src="../static/logo.png" alt="logo">
        <span>SMART GREENHOUSE</span>
    </div>
    <div class="container1">
        
        <div class="nav">
            <a href="/" type="button" class="btn btn-primary btn-lg">CROP</button></a>
            <a href="/control.html" type="button" class="btn btn-primary btn-lg">CONTROL</button></a>    
        </div>
        <div class="card-container">
                <div class="card-row">
                    <div class="card-control">
                        <input class="checkbox" id="fan" type="checkbox" name="fan" onclick="calc('fan');"/>
                        <label for="fan" class="check card-image-new" ><img src="../static/fan.png" alt=""><div class="card-crop-display">FAN</div></label>
                    </div>
                    <div class="card-control">
                        <input class="checkbox" id="light" type="checkbox" name="light" onclick="calc('light');"/>
                        <label for="light" class="check card-image-new"><img src="../static/sun.png" alt=""><div class="card-crop-display">LIGHT</div></label>
                    </div>
                </div>
                <div class="card-row">
                    <div class="card-control">
                        <input class="checkbox" id="water" type="checkbox" name="water" onclick="calc('water');"/>
                        <label for="water" class="check card-image-new"><img src="../static/drop.png" alt=""><div class="card-crop-display">WATER</div></label>
                    </div>
                    <div class="card-control">
                        <input class="checkbox" id="uv" type="checkbox" name="uv" onclick="calc('uv');" />
                        <label for="uv" class="check card-image-new"><img src="../static/uv-protection.png" alt=""><div class="card-crop-display">UV</div></label>
                    </div>
                </div>
            </div>
            <div class="card-row">
                <div class="card-display">
                    <div class="card-crop-display">HUM</div>
                    <div class="card-time-control" id="hum">70%</div>
                </div>
                <div class="card-display">
                    <div class="card-crop-display">TEMP</div>
                    <div class="card-time-control" id="temp">20 C</div>
                </div>
            </div>
            <div class="card-row">
                <div class="card-display">
                    <div class="card-crop-display">SMO</div>
                    <div class="card-time-control" id="smo">30%</div>
                </div>
                <div class="card-display">
                    <div class="card-crop-display">WATER</div>
                    <div class="card-time-control" id="water2">2</div>
                </div>
            </div>
    </div>
      <div class="charttext" style="margin:0 auto; width: 88%; text-align: center; align-items: center; background-color: white; font-family:'sans-serif'; border-radius:25px; padding:5px">
  <div class="chartjs" style="  min-height: 160px;  ">
    <canvas id="myChart"></canvas>
  </div>
  PARAMETER VISUALIZATION
  </div>
    <script>
        const url = '/write';

        function calc(x)
            {
            if (document.getElementById(x).checked) 
            {
                console.log("yoyoyo" + x);
                fetch(url+"?q="+x+"_on")
                    .then(response => response)
                    .then(data => console.log(data));
            } else {
                console.log("nononono" +x);
                fetch(url+"?q="+x+"_off")
                    .then(response => response)
                    .then(data => console.log(data));
            }
            };
            
            function valueChange(){
                    var xmlhttp = new XMLHttpRequest();
                    var url1 = "/api/list_sensor/1";
                    xmlhttp.open("GET",url1,true);
                    xmlhttp.send();
                    xmlhttp.onreadystatechange = function(){
                        if(this.readyState == 4 && this.status == 200){
                            var jsonfile1 = JSON.parse(this.responseText);
                            var hum = document.getElementById("hum");
                            var temp = document.getElementById("temp");
                            var smo = document.getElementById("smo");
                            var water2 = document.getElementById("water2");
                            hum.innerHTML = jsonfile1[0].humidity+"%";
                            temp.innerHTML = jsonfile1[0].temperature+"Â°C";
                            smo.innerHTML = jsonfile1[0]["soil_humidity"]+"%";
                            water2.innerHTML = jsonfile1[0]["water_level"];
                            console.log(this.responseText);
                        }
            };
        };
        valueChange();
        setInterval("valueChange();",14000); 
    </script>
          <script src="{{url_for('static', filename='./chart.js')}}"></script>

</body>
</html>



